import{aV as cn,r as c,aW as ut,aX as ln,a6 as un,j as a,aY as et,f as J,aZ as Tt,a_ as W,a$ as dn,b0 as dt,b1 as pn,b2 as ie,b3 as ye,b4 as T,b5 as Y,b6 as fn,b7 as ee,b8 as hn,b9 as mn,ba as pt,bb as vn,bc as ft,ay as gn,bd as ke,be as le,ar as ht,bf as yn,bg as bn,bh as wn,bi as mt,bj as Se,bk as Ce,_ as Ut,bl as xn,u as At,bm as Mt,bn as jn,bo as Pn,bp as Ae,q as En,bq as kn,br as Sn,bs as Cn,bt as $n,bu as In,bv as Rn,bw as Dt,bx as _n,by as On,bz as Wt,bA as zn,bB as Ln,bC as Tn,bD as Un,aL as Be,bE as Ke,bF as Ve,aN as An,bG as Mn,bH as Dn,bI as Nt,t as Ft,bJ as Wn,bK as Bt,z as Nn,aa as Kt,bL as Fn,bM as Bn,bN as Kn}from"./sanity-cf546c8f.js";import{A as Vn,c as qn}from"./DisplayedDocumentBroadcaster-6f8aacdc.js";function Jn({children:e,isValidProp:t,...n}){t&&cn(t),n={...c.useContext(ut),...n},n.isStatic=ln(()=>n.isStatic);const i=c.useMemo(()=>n,[JSON.stringify(n.transition),n.transformPagePoint,n.reducedMotion]);return c.createElement(ut.Provider,{value:i},e)}const Gn=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,tt=/_key\s*==\s*['"](.*)['"]/,Hn=/^\d*:\d*$/;function nt(e){return typeof e=="number"||typeof e=="string"&&/^\[\d+\]$/.test(e)}function Ie(e){return typeof e=="string"?tt.test(e.trim()):typeof e=="object"&&"_key"in e}function Vt(e){if(typeof e=="string"&&Hn.test(e))return!0;if(!Array.isArray(e)||e.length!==2)return!1;const[t,n]=e;return(typeof t=="number"||t==="")&&(typeof n=="number"||n==="")}function Xn(e,t,n){const i=typeof t=="string"?qt(t):t;if(!Array.isArray(i))throw new Error("Path must be an array or a string");let r=e;for(let o=0;o<i.length;o++){const l=i[o];if(nt(l)){if(!Array.isArray(r))return n;r=r[l]}if(Ie(l)){if(!Array.isArray(r))return n;r=r.find(m=>m._key===l._key)}if(typeof l=="string"&&(r=typeof r=="object"&&r!==null?r[l]:void 0),typeof r>"u")return n}return r}function Zn(e){if(!Array.isArray(e))throw new Error("Path is not an array");return e.reduce((t,n,i)=>{const r=typeof n;if(r==="number")return`${t}[${n}]`;if(r==="string")return`${t}${i===0?"":"."}${n}`;if(Ie(n)&&n._key)return`${t}[_key=="${n._key}"]`;if(Array.isArray(n)){const[o,l]=n;return`${t}[${o}:${l}]`}throw new Error(`Unsupported path segment \`${JSON.stringify(n)}\``)},"")}function qt(e){if(typeof e!="string")throw new Error("Path is not a string");const t=e.match(Gn);if(!t)throw new Error("Invalid path string");return t.map(Qn)}function Qn(e){return nt(e)?Yn(e):Ie(e)?er(e):Vt(e)?tr(e):e}function Yn(e){return Number(e.replace(/[^\d]/g,""))}function er(e){return{_key:e.match(tt)[1]}}function tr(e){const[t,n]=e.split(":").map(i=>i===""?i:Number(i));return[t,n]}var Jt=Object.freeze({__proto__:null,fromString:qt,get:Xn,isIndexSegment:nt,isIndexTuple:Vt,isKeySegment:Ie,reKeySegment:tt,toString:Zn});const vt="drafts.";function $i(e){return e.startsWith(vt)?e.slice(vt.length):e}const gt={"\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t","'":"\\'","\\":"\\\\"},yt={"\\f":"\f","\\n":`
`,"\\r":"\r","\\t":"	","\\'":"'","\\\\":"\\"};function nr(e){return`$${e.map(t=>typeof t=="string"?`['${t.replace(/[\f\n\r\t'\\]/g,n=>gt[n])}']`:typeof t=="number"?`[${t}]`:t._key!==""?`[?(@._key=='${t._key.replace(/['\\]/g,n=>gt[n])}')]`:`[${t._index}]`).join("")}`}function Ii(e){const t=[],n=/\['(.*?)'\]|\[(\d+)\]|\[\?\(@\._key=='(.*?)'\)\]/g;let i;for(;(i=n.exec(e))!==null;){if(i[1]!==void 0){const r=i[1].replace(/\\(\\|f|n|r|t|')/g,o=>yt[o]);t.push(r);continue}if(i[2]!==void 0){t.push(parseInt(i[2],10));continue}if(i[3]!==void 0){const r=i[3].replace(/\\(\\')/g,o=>yt[o]);t.push({_key:r,_index:-1});continue}}return t}function rr(e){return e.map(t=>{if(typeof t=="string"||typeof t=="number")return t;if(t._index!==-1)return t._index;throw new Error(`invalid segment:${JSON.stringify(t)}`)})}function Ri(e,t){if(!(t!=null&&t.mappings))return;const n=nr(rr(e));if(t.mappings[n]!==void 0)return{mapping:t.mappings[n],matchedPath:n,pathSuffix:""};const i=Object.entries(t.mappings).filter(([m])=>n.startsWith(m)).sort(([m],[d])=>d.length-m.length);if(i.length==0)return;const[r,o]=i[0],l=n.substring(r.length);return{mapping:o,matchedPath:r,pathSuffix:l}}function ir(e){return e!==null&&Array.isArray(e)}function bt(e){return typeof e=="object"&&e!==null}function Me(e,t,n=[]){return ir(e)?e.map((i,r)=>{if(bt(i)){const o=i._key;if(typeof o=="string")return Me(i,t,n.concat({_key:o,_index:r}))}return Me(i,t,n.concat(r))}):bt(e)?Object.fromEntries(Object.entries(e).map(([i,r])=>[i,Me(r,t,n.concat(i))])):t(e,n)}const Gt="sanity.previewUrlSecret",or="sanity-preview-url-secret",ar="2023-11-09",Re="sanity-preview-secret",rt="sanity-preview-pathname",sr=3600,cr=`*[_type == "${Gt}" && dateTime(_updatedAt) <= dateTime(now()) - 3600]`,lr="sanity.preview-url-secret";function ur(e){const t=new URL(e);return t.searchParams.delete(rt),t.searchParams.delete(Re),t}function dr(e){return e.searchParams.has(Re)}function pr(e,t,n){const i=new URL(e);return i.searchParams.set(Re,t),i.searchParams.set(rt,n),i}async function Ht(e,t,n,i,r=un()){const o=e.withConfig({apiVersion:ar});try{const l=new Date(Date.now()+1e3*sr),m=`${or}.${r}`,d=function(){if(typeof crypto<"u"){const p=new Uint8Array(16);crypto.getRandomValues(p);let s="";for(let f=0;f<p.length;f++)s+=p[f].toString(16).padStart(2,"0");return s=btoa(s).replace(/\+/g,"-").replace(/\//g,"_").replace(/[=]+$/,""),s}return Math.random().toString(36).slice(2)}(),h=o.patch(m).set({secret:d,source:t,studioUrl:n,userId:i});return await o.transaction().createOrReplace({_id:m,_type:Gt}).patch(h).commit({tag:lr}),{secret:d,expiresAt:l}}finally{await o.delete({query:cr})}}function fr(e){const{draftMode:t,previewMode:n,origin:i=typeof location>"u"?"https://localhost":location.origin}=e,r=(n==null?void 0:n.enable)||(t==null?void 0:t.enable);let{preview:o="/"}=e;const l=new URL(o,i),m=r?new URL(r,i):void 0;return async d=>{try{if(d.previewSearchParam){const p=new URL(d.previewSearchParam,l);p.origin===l.origin&&(o=`${p.pathname}${p.search}`)}else if(d.referrer){const p=new URL(d.referrer);p.origin===l.origin&&(o=`${p.pathname}${p.search}`)}}catch{}typeof location<"u"&&location.origin===l.origin&&d.studioBasePath&&(o.startsWith(`${d.studioBasePath}/`)||o===d.studioBasePath)&&(o=e.preview||"/");const h=new URL(o,l);if(m){const p=new URL(m),{searchParams:s}=p;return s.set(Re,d.previewUrlSecret),h.pathname!==p.pathname&&s.set(rt,`${h.pathname}${h.search}`),p.toString()}return h.toString()}}const hr=e=>typeof e=="object"&&typeof e.then=="function",xe=[];function mr(e,t,n=(i,r)=>i===r){if(e===t)return!0;if(!e||!t)return!1;const i=e.length;if(t.length!==i)return!1;for(let r=0;r<i;r++)if(!n(e[r],t[r]))return!1;return!0}function vr(e,t=null,n=!1,i={}){t===null&&(t=[e]);for(const o of xe)if(mr(t,o.keys,o.equal)){if(n)return;if(Object.prototype.hasOwnProperty.call(o,"error"))throw o.error;if(Object.prototype.hasOwnProperty.call(o,"response"))return i.lifespan&&i.lifespan>0&&(o.timeout&&clearTimeout(o.timeout),o.timeout=setTimeout(o.remove,i.lifespan)),o.response;if(!n)throw o.promise}const r={keys:t,equal:i.equal,remove:()=>{const o=xe.indexOf(r);o!==-1&&xe.splice(o,1)},promise:(hr(e)?e:e(...t)).then(o=>{r.response=o,i.lifespan&&i.lifespan>0&&(r.timeout=setTimeout(r.remove,i.lifespan))}).catch(o=>r.error=o)};if(xe.push(r),!n)throw r.promise}const wt=(e,t,n)=>vr(e,t,!1,n);var gr=Object.defineProperty,yr=(e,t,n)=>(((i,r,o)=>{r in i?gr(i,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[r]=o})(e,typeof t!="symbol"?t+"":t,n),n);let je;const br=new Uint8Array(16);function wr(){if(!je&&(je=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!je))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return je(br)}const D=[];for(let e=0;e<256;++e)D.push((e+256).toString(16).slice(1));var xt={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function Pe(e,t,n){if(xt.randomUUID&&!t&&!e)return xt.randomUUID();const i=(e=e||{}).random||(e.rng||wr)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t){n=n||0;for(let r=0;r<16;++r)t[n+r]=i[r];return t}return function(r,o=0){return D[r[o+0]]+D[r[o+1]]+D[r[o+2]]+D[r[o+3]]+"-"+D[r[o+4]]+D[r[o+5]]+"-"+D[r[o+6]]+D[r[o+7]]+"-"+D[r[o+8]]+D[r[o+9]]+"-"+D[r[o+10]]+D[r[o+11]]+D[r[o+12]]+D[r[o+13]]+D[r[o+14]]+D[r[o+15]]}(i)}const xr=1e3,jr=1e3,Pr=500,Er=["handshake/syn","handshake/syn-ack","handshake/ack"],jt=e=>Er.some(t=>t===e),kr=({data:e={}})=>typeof e=="object"&&e!==null&&!Array.isArray(e)&&!("domain"in e)&&["id","type","from","to"].every(t=>t in e)&&e.type.startsWith("handshake/");function Pt(e){const t=e.target,n=e.connectTo.map(s=>({buffer:[],config:s,id:"",handler:r,status:"connecting",interval:void 0,heartbeat:void 0}));function i(s){window.clearInterval(s.interval)}function r(s){const{data:f}=s;if(jt(f.type)){const u=n.find(y=>y.config.id===f.from);u&&f.type==="handshake/syn-ack"&&(d(u,"connected"),h(u,"handshake/ack",{id:u.id}))}}const o=s=>{var f,u,y;const w=s.data;if(!jt(w.type)&&n.find(g=>g.id===w.connectionId)){const g=n.find(b=>b.config.id===w.from);if(g){const b=[w.type,w.data];(u=(f=g.config).onEvent)==null||u.call(f,...b),(y=e.onEvent)==null||y.call(e,...b),p(g,"channel/response",{responseTo:w.id},!1)}}};function l(s){var f;if(kr(s))console.error(`Visual editing package mismatch detected! Please ensure you are using the latest version of Sanity Studio and any packages listed here:
https://github.com/sanity-io/visual-editing`);else if(function(u){const{data:y,origin:w}=u;return y.domain==="sanity/channels"&&y.to==e.id&&n.map(g=>g.config.id).includes(y.from)&&y.type!=="channel/response"&&w===e.targetOrigin}(s)){const{data:u}=s;(f=n.find(y=>y.config.id===u.from))==null||f.handler(s)}}function m(s){s.heartbeat&&window.clearInterval(s.heartbeat)}function d(s,f){var u,y,w;s.status=f,(y=(u=s.config).onStatusUpdate)==null||y.call(u,f,s.config.id),(w=e.onStatusUpdate)==null||w.call(e,f,s.config.id),f==="connecting"||f==="reconnecting"?(s.handler=r,m(s),function(g){g.id=Pe(),g.interval=window.setInterval(()=>{h(g,"handshake/syn",{id:g.id})},Pr)}(s)):f==="connected"?(s.handler=o,i(s),function(g){if(m(g),g.config.heartbeat){const b=typeof g.config.heartbeat=="number"?g.config.heartbeat:jr;g.heartbeat=window.setInterval(()=>{p(g,"channel/heartbeat")},b)}}(s),function(g){const b=[...g.buffer];g.buffer.splice(0,g.buffer.length),b.forEach(({type:P,data:v})=>{p(g,P,v)})}(s)):f==="disconnected"&&(s.id=null,s.handler=r,i(s),m(s))}function h(s,f,u){if(!s.id)throw new Error("No channel ID set");const y={connectionId:s.id,data:u,domain:"sanity/channels",from:e.id,id:Pe(),to:s.config.id,type:f};try{t==null||t.postMessage(y,{targetOrigin:"*"})}catch{throw new Error(`Failed to postMessage '${y.id}' on '${e.id}'`)}}function p(s,f,u,y=!0){const w=Pe();if(s.status==="connecting"||s.status==="reconnecting"||s.status==="disconnected")return void s.buffer.push({type:f,data:u});if(!s.id)throw new Error("No channel ID set");const g={connectionId:s.id,data:u,domain:"sanity/channels",from:e.id,id:w,to:s.config.id,type:f};if(y){const b=setTimeout(()=>{g.connectionId===s.id&&(window.removeEventListener("message",P,!1),f!=="channel/heartbeat"&&s.buffer.push({type:f,data:u}),d(s,"reconnecting"),console.warn(`Received no response to message '${g.type}' on client '${e.id}' (ID: '${g.id}').`))},xr),P=v=>{var $;const{data:j}=v;j.type==="channel/response"&&($=j.data)!=null&&$.responseTo&&j.data.responseTo===g.id&&(window.removeEventListener("message",P,!1),clearTimeout(b))};window.addEventListener("message",P,!1)}try{t==null||t.postMessage(g,{targetOrigin:e.targetOrigin})}catch{throw new Error(`Failed to postMessage '${g.id}' on client '${e.id}'`)}}return window.addEventListener("message",l,!1),n.forEach(s=>{d(s,"connecting")}),{destroy:function(){n.forEach(s=>{["disconnected"].includes(s.status)||(p(s,"channel/disconnect",{id:s.id},!1),d(s,"disconnected"))}),window.removeEventListener("message",l,!1),n.forEach(s=>{m(s),i(s)})},send:function(s,f,u){(s?Array.isArray(s)?[...s]:[s]:n).forEach(y=>{const w=n.find(g=>g.config.id===y);if(!w)throw new Error("Invalid channel ID");p(w,f,u)})}}}var Sr=class extends Error{constructor(e){super(e[0].message),yr(this,"issues"),this.name="ValiError",this.issues=e}};function qe(e,t){return Array.isArray(e)?[void 0,e]:[e,t]}function Xt(e,t,n,i,r){var o,l,m,d,h;const p=(h=(d=(m=(l=(o=t.message)!=null?o:function(s,f){var u;return(u=void 0)==null?void 0:u.get(f)}(n,r.lang))!=null?l:e?(r.lang,void 0):null)!=null?m:i==null?void 0:i.message)!=null?d:function(s){}(r.lang))!=null?h:r.message;return typeof p=="function"?p(r):p}function _e(e,t,n){return{typed:e,output:t,issues:n}}function it(e){let t=typeof e;return t==="object"&&(t=e?Object.getPrototypeOf(e).constructor.name:"null"),t==="string"?`"${e}"`:t==="number"||t==="bigint"||t==="boolean"?`${e}`:t}function Cr(e,t,n){var i;const r=(i=n.received)!=null?i:it(n.input),o={reason:e.type,context:n.context.type,expected:n.context.expects,received:r,message:`Invalid ${n.label}: ${n.context.expects?`Expected ${n.context.expects} but r`:"R"}eceived ${r}`,input:n.input,requirement:n.context.requirement,path:n.path,lang:t==null?void 0:t.lang,abortEarly:t==null?void 0:t.abortEarly,abortPipeEarly:t==null?void 0:t.abortPipeEarly,skipPipe:t==null?void 0:t.skipPipe};return o.message=Xt(!1,n.context,n.reference,t,o),o}function Zt(e,t,n,i){if(e.pipe&&(n==null||!n.skipPipe))for(const r of e.pipe){const o=r._parse(t);if(o.issues){for(const l of o.issues){const m=Cr(e,n,l);i?i.push(m):i=[m]}if(n!=null&&n.abortEarly||n!=null&&n.abortPipeEarly)break}else t=o.output}return _e(!0,t,i)}function ot(e,t,n,i,r){var o,l;const m=it(n),d=(o=r==null?void 0:r.expected)!=null?o:e.expects,h={reason:(l=r==null?void 0:r.reason)!=null?l:"type",context:e.type,expected:d,received:m,message:`Invalid type: Expected ${d} but received ${m}`,input:n,path:r==null?void 0:r.path,issues:r==null?void 0:r.issues,lang:i==null?void 0:i.lang,abortEarly:i==null?void 0:i.abortEarly,abortPipeEarly:i==null?void 0:i.abortPipeEarly,skipPipe:i==null?void 0:i.skipPipe};return h.message=Xt(!0,e,t,i,h),{typed:!1,output:n,issues:[h]}}function Qt(e,t){return{...e,fallback:t,_parse(n,i){const r=e._parse(n,i);return r.issues?_e(!0,function(o,l){return typeof o.fallback=="function"?o.fallback(l):o.fallback}(this,{input:n,issues:r.issues})):r}}}function Ee(e,t,n,i){const[r,o,l]=function(d,h,p){if(!d||typeof d=="object"&&!Array.isArray(d)){const[u,y]=qe(h,p);return[d,u,y]}const[s,f]=qe(d,h);return[void 0,s,f]}(t,n,i);let m;return{type:"object",expects:"Object",async:!1,entries:e,rest:r,message:o,pipe:l,_parse(d,h){if(d&&typeof d=="object"){m=m??Object.entries(this.entries);let p,s=!0;const f={};for(const[u,y]of m){const w=d[u],g=y._parse(w,h);if(g.issues){const b={type:"object",origin:"value",input:d,key:u,value:w};for(const P of g.issues)P.path?P.path.unshift(b):P.path=[b],p==null||p.push(P);if(p||(p=g.issues),h!=null&&h.abortEarly){s=!1;break}}g.typed||(s=!1),(g.output!==void 0||u in d)&&(f[u]=g.output)}if(this.rest&&(h==null||!h.abortEarly||!p)){for(const u in d)if(!(u in this.entries)){const y=d[u],w=this.rest._parse(y,h);if(w.issues){const g={type:"object",origin:"value",input:d,key:u,value:y};for(const b of w.issues)b.path?b.path.unshift(g):b.path=[g],p==null||p.push(b);if(p||(p=w.issues),h!=null&&h.abortEarly){s=!1;break}}w.typed||(s=!1),f[u]=w.output}}return s?Zt(this,f,h,p):_e(!1,f,p)}return ot(this,Ee,d,h)}}}function Oe(e,t){return{type:"picklist",expects:e.map(it).join(" | "),async:!1,options:e,message:t,_parse(n,i){return this.options.includes(n)?_e(!0,n):ot(this,Oe,n,i)}}}function Je(e,t,n){const i=e._parse(t,function(r){var o,l,m,d;return{lang:(o=r==null?void 0:r.lang)!=null?o:void 0,message:r==null?void 0:r.message,abortEarly:(l=r==null?void 0:r.abortEarly)!=null?l:void 0,abortPipeEarly:(m=r==null?void 0:r.abortPipeEarly)!=null?m:void 0,skipPipe:(d=r==null?void 0:r.skipPipe)!=null?d:void 0}}(n));if(i.issues)throw new Sr(i.issues);return i.output}const $r=/^([A-Za-z]+):([0-9]+)$/,Ir=/^([A-Za-z]+):([0-9]+),([0-9]+)$/,Rr=/^([A-Za-z]+):([a-z0-9]+)$/;function _r(e,t){return`${e}-${typeof t=="string"?t:JSON.stringify(t)}`}const Et={alt:"altKey",ctrl:"ctrlKey",mod:typeof window<"u"&&/Mac|iPod|iPhone|iPad/.test(window.navigator.platform)?"metaKey":"ctrlKey",shift:"shiftKey"};function kt(e){return e.key==="Alt"}function at(e){const{children:t,message:n,onRetry:i,onContinueAnyway:r,...o}=e,l=a.jsx(Y,{fontSize:1,mode:"ghost",onClick:i,text:"Retry"}),m=a.jsx(Y,{fontSize:1,mode:"ghost",tone:"critical",onClick:r,text:"Continue anyway"});return a.jsx(ie,{height:"fill",...o,children:a.jsx(W,{align:"center",height:"fill",justify:"center",children:a.jsx(In,{padding:4,sizing:"border",width:0,children:a.jsxs(le,{space:4,children:[a.jsxs(le,{space:3,children:[a.jsx(T,{size:1,weight:"semibold",children:"An error occured"}),a.jsx(T,{muted:!0,size:1,children:n})]}),t,i&&r?a.jsxs(Rn,{space:2,children:[l,m]}):i?a.jsx(ee,{children:l}):r?a.jsx(ee,{children:m}):null]})})})})}function ze(){const e=c.useContext(Dt);if(!e)throw new Error("Presentation context is missing");return e}function Or(e){const t=["comment","inspect","instruction","pathKey","rev","since","template","view"];return function(n={}){const i=Object.entries(n).map(([r,o])=>`${r}=${o}`).join("&");return i.length?`?${i}`:""}(Object.entries(e).filter(([n])=>t.includes(n)).reduce((n,[i,r])=>r==null?n:{...n,[i]:r},{}))}const zr=c.forwardRef(function(e,t){const{params:n,structureParams:i}=ze();return a.jsx(et,{...e,ref:t,state:{type:void 0,_searchParams:Object.entries({...i,preview:n.preview})},title:void 0})}),Lr=c.forwardRef(function(e,t){const{documentId:n,documentType:i,parentRefPath:r,template:o,...l}=e;return a.jsx(et,{...l,ref:t,state:{id:n,type:i,_searchParams:Object.entries({preview:e.previewUrl})},title:void 0})});function Yt(e){const{children:t,onStructureParams:n,params:i,previewUrl:r,refs:o}=e,{state:l,resolvePathFromState:m}=At(),d=Mt(Object.fromEntries(l._searchParams||[])),h=c.useCallback(s=>`${m(l)}${Or({...d,...s})}`,[m,d,l]),p=c.useMemo(()=>({index:0,groupIndex:0,siblingIndex:0,payload:{},params:i,hasGroupSiblings:!1,groupLength:1,routerPanesState:[],ChildLink:s=>{const{childId:f,...u}=s,y=o==null?void 0:o.find(w=>w._id===f||Bt(w._id)===f);return y?a.jsx(et,{...u,state:{id:f,type:y._type,_searchParams:Object.entries({preview:r})}}):a.jsx("div",{...u})},BackLink:zr,ReferenceChildLink:s=>a.jsx(Lr,{...s,previewUrl:r}),ParameterizedLink:()=>a.jsx(a.Fragment,{children:"ParameterizedLink"}),closeCurrentAndAfter:()=>{console.warn("closeCurrentAndAfter")},handleEditReference:s=>{console.warn("handleEditReference",s)},replaceCurrent:s=>{console.warn("replaceCurrent",s)},closeCurrent:()=>{console.warn("closeCurrent")},duplicateCurrent:s=>{console.warn("duplicateCurrent",s)},setView:s=>{console.warn("setView",s)},setParams:s=>{var f;n({...s,inspect:(f=s.inspect)!=null?f:void 0})},setPayload:s=>{console.warn("setPayload",s)},navigateIntent:(s,f,u)=>{console.warn("navigateIntent",s,f,u)},createPathWithParams:h}),[h,n,i,r,o]);return a.jsx(Nn.Provider,{value:p,children:t})}const Tr=J(Kt)`
  height: 100%;
`,Ur=J(W)`
  & > div {
    min-width: none !important;
    max-width: none !important;
  }
`,Ar=J(Ce)`
  white-space: pre-wrap;
`;function Mr(e){const{onStructureParams:t,previewUrl:n,refs:i}=e,{devMode:r}=ze(),o=c.useMemo(()=>({id:"$root",options:{filter:"_id in $ids",params:{ids:i.map(p=>p._id)}},schemaTypeName:"",title:"Documents on this page",type:"documentList"}),[i]),[l,m]=c.useState(null),d=c.useCallback(()=>m(null),[]),[h]=c.useState(()=>({}));return c.useEffect(()=>m(null),[i]),l?a.jsx(at,{flex:1,message:"Could not render the document list",onRetry:d,children:r&&a.jsx(ie,{overflow:"auto",padding:3,radius:2,tone:"critical",children:a.jsxs(le,{space:3,children:[a.jsx(Se,{muted:!0,size:0,children:"Error message"}),a.jsx(Ar,{size:1,children:l.error.message})]})})}):a.jsx(Nt,{onCatch:m,children:a.jsx(Tr,{children:a.jsx(Ft,{children:a.jsx(Yt,{onStructureParams:t,params:h,previewUrl:n,refs:i,children:a.jsx(Ur,{direction:"column",flex:1,children:a.jsx(Wn,{index:0,itemId:"$root",pane:o,paneKey:"$root"})})})})})})}const Dr=J(Ce)`
  white-space: pre-wrap;
`;function Wr(e){const{documentId:t,documentType:n,onFocusPath:i,onStructureParams:r,params:o,previewUrl:l}=e,{template:m,templateParams:d}=o,{devMode:h}=ze(),p=c.useMemo(()=>({id:t,options:{id:t,type:n,template:m,templateParameters:Fn(d)},title:"",type:"document"}),[t,n,m,d]),[s,f]=c.useState(null),u=c.useCallback(()=>f(null),[]);return c.useEffect(()=>{f(null)},[t,n,o]),s?a.jsx(at,{flex:1,message:"Could not render the document editor",onRetry:u,children:h&&a.jsx(ie,{overflow:"auto",padding:3,radius:2,tone:"critical",children:a.jsxs(le,{space:3,children:[a.jsx(Se,{muted:!0,size:0,children:"Error message"}),a.jsx(Dr,{size:1,children:s.error.message})]})})}):a.jsx(Nt,{onCatch:f,children:a.jsx(Kt,{style:{height:"100%"},children:a.jsx(Yt,{onStructureParams:r,params:o,previewUrl:l,children:a.jsx(Bn,{paneKey:"document",index:1,itemId:"document",pane:p,onFocusPath:i})})})})}function Nr(e){const{documentId:t,documentType:n,onFocusPath:i,onStructureParams:r,previewUrl:o,structureParams:l}=e;return a.jsx(Ft,{children:a.jsx(Wr,{documentId:t,documentType:n,onFocusPath:i,onStructureParams:r,params:l,previewUrl:o})})}function Fr(e){const{documentId:t,documentType:n,onFocusPath:i,onStructureParams:r,previewUrl:o,refs:l,structureParams:m}=e;return t&&n?a.jsx(Nr,{documentId:t,documentType:n,onFocusPath:i,onStructureParams:r,previewUrl:o,structureParams:m}):a.jsx(Mr,{onStructureParams:r,previewUrl:o,refs:l})}const Le=c.createContext(null);Le.displayName="PanelsContext";const Br=J.div`
  overflow: hidden;
  flex-basis: 0;
  flex-shrink: 1;
`,Ge=function({children:e,defaultSize:t=null,id:n,minWidth:i,maxWidth:r,order:o=0}){const l=c.useContext(Le);if(l===null)throw Error("Panel components must be rendered within a PanelGroup container");const{getPanelStyle:m,registerElement:d,unregisterElement:h}=l,p=m(n);return c.useLayoutEffect(()=>(d(n,{id:n,type:"panel",defaultSize:t,maxWidth:r??null,minWidth:i??0,order:o}),()=>{h(n)}),[n,t,o,r,i,d,h]),a.jsx(Br,{style:p,children:e})},Kr=J.div`
  position: relative;
`,Vr=J.div`
  position: absolute;
  top: 0;
  bottom: 0;
  left: -5px;
  width: 9px;
  z-index: 10;
  cursor: ${({$disabled:e})=>e?"auto":"ew-resize"};

  /* Border */
  & > span:nth-child(1) {
    display: block;
    border-left: 1px solid var(--card-border-color);
    position: absolute;
    top: 0;
    left: 4px;
    bottom: 0;
    transition: opacity 200ms;
  }

  ${({$disabled:e})=>!e&&`
    /* Hover effect */
    & > span:nth-child(2) {
      display: block;
      position: absolute;
      top: 0;
      left: 0;
      width: 9px;
      bottom: 0;
      background-color: var(--card-border-color);
      opacity: 0;
      transition: opacity 150ms;
    }

    @media (hover: hover) {
      &:hover > span:nth-child(2) {
        opacity: 0.2;
      }
    }
  `}
`,en=function({id:e,order:t,disabled:n=!1}){const i=c.useRef(null),r=c.useContext(Le);if(r===null)throw Error("Panel components must be rendered within a PanelGroup container");const o=function(g){return c.useRef(g||Pe()).current}(e),{activeResizer:l,drag:m,startDragging:d,stopDragging:h,registerElement:p,unregisterElement:s}=r,f=l===o;if(r===null)throw Error("Panel components must be rendered within a PanelGroup container");const u=c.useCallback(g=>{d(o,g.nativeEvent)},[o,d]),y=c.useCallback(g=>{m(o,g)},[o,m]),w=c.useCallback(()=>{i.current.blur(),h()},[h]);return c.useEffect(()=>{if(f&&!n)return window.addEventListener("mousemove",y),window.addEventListener("mouseup",w),()=>{window.removeEventListener("mousemove",y),window.removeEventListener("mouseup",w)}},[n,f,y,w]),c.useLayoutEffect(()=>(p(o,{id:o,order:t,type:"resizer",el:i}),()=>{s(o)}),[o,t,p,s]),a.jsx(Kr,{onMouseDown:u,ref:i,children:a.jsxs(Vr,{$disabled:n,children:[a.jsx("span",{}),a.jsx("span",{})]})})};function tn(e,t){let n;return(...i)=>{clearTimeout(n),n=setTimeout(()=>{e.apply(e,i)},t)}}const nn="presentation/panels",St=()=>JSON.parse(localStorage.getItem(nn)||"{}"),Ct=e=>e.map(t=>[t.id,t.order].join(":")).join(",");function qr(){return c.useMemo(()=>{const e=(t,n)=>{const i=St(),r=Ct(t);(o=>{localStorage.setItem(nn,JSON.stringify(o))})({...i,[r]:n})};return{get:t=>St()[Ct(t)],set:e,setDebounced:tn(e,100)}},[])}function He(e,t,n){const{maxWidth:i,minWidth:r}=e,o=i==null?100:i/n*100,l=r/n*100;return Math.min(o,Math.max(l,t))}function Jr(e,t,n){if(e.length===1)return"100";const i=n[e.findIndex(r=>r.id===t)];return i==null?"0":i.toPrecision(10)}function $t(e,t,n=0,i=null){return e.clientX-(i||t.getBoundingClientRect()).left-n}function De(e){return e.type==="panel"}function It(e){return e.type==="resizer"}function Rt(e){return Array.from(e.values()).sort(({order:t},{order:n})=>t==null&&n==null?0:t==null?-1:n==null?1:t-n)}function _t(e,t,n){const i=t.reduce((l,m)=>l+m,0),r=[...t].map(l=>l/i*100);let o=0;for(let l=0;l<e.length;l++){const m=e[l],d=r[l],h=He(m,d,n);d!=h&&(o+=d-h,r[l]=h)}if(o.toFixed(3)!=="0.000")for(let l=0;l<e.length;l++){const m=e[l];let{maxWidth:d,minWidth:h}=m;h=h/n*100,d!=null&&(d=d/n*100);const p=Math.min(d??100,Math.max(h,r[l]+o));if(p!==r[l]&&(o-=p-r[l],r[l]=p,Math.abs(o).toFixed(3)==="0.000"))break}return r}const Gr=J.div`
  display: flex;
  flex-direction: row;
  height: 100%;
  overflow: hidden;
  width: 100%;
`,Hr=function({children:e}){const t=c.useRef(null),[n,i]=c.useState(new Map),r=c.useMemo(()=>Rt(n).filter(De),[n]),[o,l]=c.useState([]),[m,d]=c.useState(null),h=c.useRef({elements:n,panels:r,widths:o}),p=c.useCallback(v=>({flexGrow:Jr(r,v,o),pointerEvents:m===null?void 0:"none"}),[m,r,o]),s=c.useCallback((v,$)=>{i(j=>{if(j.has(v))return j;const k=new Map(j);return k.set(v,$),k})},[]),f=c.useCallback(v=>{i($=>{if(!$.has(v))return $;const j=new Map($);return j.delete(v),j})},[]),u=c.useRef({containerWidth:window.innerWidth,dragOffset:0,panelAfter:null,panelBefore:null,resizerIndex:-1,resizerRect:null,startX:0,widths:[]}),y=c.useCallback((v,$)=>{const j=Rt(n),k=j.findIndex(I=>I.id===v),R=n.get(v);if(!R||!It(R))return;const O=R.el.current;O&&(u.current={resizerIndex:k,panelBefore:j.reduce((I,z,_)=>De(z)&&_<k?z:I,null),panelAfter:j.reduce((I,z,_)=>I===null&&De(z)&&_>k?z:I,null),containerWidth:window.innerWidth,startX:$.pageX,dragOffset:$t($,O),resizerRect:O.getBoundingClientRect(),widths:h.current.widths},d(v))},[n]),w=c.useCallback(()=>{d(null)},[]),g=c.useCallback((v,$)=>{$.preventDefault(),$.stopPropagation();const{containerWidth:j,dragOffset:k,panelBefore:R,panelAfter:O,resizerRect:I}=u.current;if(R==null||O==null)return;const z=n.get(v);if(!z||!It(z))return;const _=z.el.current;if(!_)return;const pe=$t($,_,k,I);if(pe===0)return;const{widths:te}=h.current,fe=function(U,ne,A,oe,ae,he){const{panels:G,widths:re}=ae,{widths:N}=he,F=N||re,ue=[...F];{const X=U<0?oe:A,K=F[G.findIndex(Te=>Te.id===X.id)],Z=He(X,K+Math.abs(U),ne);if(K===Z)return F;U=U<0?K-Z:Z-K}let de=0,me=U<0?A:oe,H=G.findIndex(X=>X.id===me.id);for(;;){const X=G[H],K=F[H],Z=He(X,K-(Math.abs(U)-Math.abs(de)),ne);if(K!==Z&&(de+=K-Z,ue[H]=Z,de.toPrecision(10).localeCompare(Math.abs(U).toPrecision(10),void 0,{numeric:!0})>=0))break;if(U<0){if(--H<0)break}else if(++H>=G.length)break}return de===0?F:(me=U<0?oe:A,H=G.findIndex(X=>X.id===me.id),ue[H]=F[H]+de,ue)}(pe/t.current.getBoundingClientRect().width*100,j,R,O,h.current,u.current);te.some((U,ne)=>U!==fe[ne])&&l(fe)},[n]);c.useLayoutEffect(()=>{h.current.elements=n,h.current.panels=r,h.current.widths=o},[n,r,o]);const b=qr();c.useLayoutEffect(()=>{const{widths:v}=h.current;if(v.length===r.length)return;const $=b.get(r);if($){const k=_t(r,$,window.innerWidth);return void l(k)}const j=function(k){let R=k.length,O=100;const I=k.map(_=>_.defaultSize?(O-=_.defaultSize,R-=1,_.defaultSize):null),z=O/R;return I.map(_=>_===null?z:_)}(r);l(j)},[b,r]),c.useEffect(()=>{o.length&&b.setDebounced(r,o)},[b,r,o]),c.useLayoutEffect(()=>{const v=new ResizeObserver(()=>{const{panels:$,widths:j}=h.current,k=_t($,j,window.innerWidth);j.some((R,O)=>R!==k[O])&&l(k)});return v.observe(t.current),()=>{v.disconnect()}},[]);const P=c.useMemo(()=>({activeResizer:m,drag:g,getPanelStyle:p,registerElement:s,startDragging:y,stopDragging:w,unregisterElement:f}),[m,g,p,s,y,w,f]);return a.jsx(Le.Provider,{value:P,children:a.jsx(Gr,{ref:t,children:e})})},Xr=function(e){const{children:t,navigate:n}=e,i=c.useCallback((r,o=void 0)=>{n(o||{},r?{preview:r}:{})},[n]);return a.jsx(_n.Provider,{value:i,children:t})};function Zr(e){const{unstable_navigator:t}=e,n=!(t==null||!t.component),[i,r]=function(d,h){const[p,s]=c.useState(()=>{var f;return JSON.parse((f=localStorage.getItem(d))!=null?f:JSON.stringify(h))});return c.useEffect(()=>{localStorage.setItem(d,JSON.stringify(p))},[d,p]),[p,s]}("presentation/navigator",n),o=!!n&&i,l=c.useMemo(()=>{if(n)return()=>r(d=>!d)},[n,r]),m=c.useCallback(function(){return a.jsx(a.Fragment,{children:o&&a.jsx(Qr,{...t})})},[o,t]);return[{navigatorEnabled:o,toggleNavigator:l},m]}const Qr=c.memo(function(e){const{minWidth:t,maxWidth:n,component:i}=e,r=t!=null&&n!=null&&t===n;return a.jsxs(a.Fragment,{children:[a.jsx(Ge,{id:"navigator",minWidth:t,maxWidth:n,order:1,children:a.jsx(i,{})}),a.jsx(en,{order:2,disabled:r})]})}),Yr=function(e){const{children:t,params:n}=e,i=c.useMemo(()=>n,[n]);return a.jsx(On.Provider,{value:i,children:t})},ei=function(e){const{children:t,devMode:n,name:i,navigate:r,params:o,structureParams:l}=e,m=c.useMemo(()=>({devMode:n,name:i,navigate:r,params:o,structureParams:l}),[n,i,r,o,l]);return a.jsx(Dt.Provider,{value:m,children:t})},st="ACTION_IFRAME_LOADED",Xe="ACTION_IFRAME_REFRESH",Ze="ACTION_IFRAME_RELOAD",Qe="ACTION_PERSPECTIVE",Ye="ACTION_VIEWPORT",rn="ACTION_VISUAL_EDITING_OVERLAYS_TOGGLE",ti=(e,t)=>{switch(t.type){case st:return e.iframe.status==="loaded"?e:{...e,iframe:{...e.iframe,status:"loaded"}};case Xe:return e.iframe.status==="refreshing"?e:{...e,iframe:{...e.iframe,status:"refreshing"}};case Ze:return e.iframe.status==="reloading"?e:{...e,iframe:{...e.iframe,status:"reloading"}};case Qe:return{...e,perspective:Je(on,t.perspective)};case Ye:return{...e,viewport:Je(an,t.viewport)};case rn:return ni(e,t);default:return e}},ni=(e,t)=>e.visualEditing.overlaysEnabled===t.enabled?e:{...e,visualEditing:{...e.visualEditing,overlaysEnabled:t.enabled}},ri=Oe(["loading","loaded","refreshing","reloading"]),on=Qt(Oe(["published","previewDrafts"]),"previewDrafts"),an=Qt(Oe(["desktop","mobile"]),"desktop"),ii=Ee({iframe:Ee({status:ri}),perspective:on,viewport:an,visualEditing:Ee({overlaysEnabled:function e(t,n){const[i,r]=qe(t,n);return{type:"boolean",expects:"boolean",async:!1,message:i,pipe:r,_parse(o,l){return typeof o=="boolean"?Zt(this,o,l):ot(this,e,o,l)}}}()})}),oi={iframe:{status:"loading"},perspective:"previewDrafts",viewport:"desktop",visualEditing:{overlaysEnabled:!1}};function ai(e){return Je(ii,{...oi,...e})}const si=Tt(J.iframe`
  border: 0;
  max-height: 100%;
  width: 100%;
  display: block;
`),ci=function(e){var t;const{basePath:n="/"}=((t=Wt())==null?void 0:t.activeWorkspace)||{},{fontSize:i=1,onChange:r,origin:o,padding:l=3,value:m}=e,d=c.useRef(null),[h,p]=c.useState(void 0),[s,f]=c.useState(void 0),u=c.useCallback(b=>{p(b.currentTarget.value)},[]),y=c.useCallback(b=>{var P;if(b.key==="Enter"){if(h===void 0)return;const v=h.startsWith("/")||h===""?`${o}${h}`:h;if(!v.startsWith(o+"/")&&v!==o)return void f(`URL must start with ${o}`);if(!o&&(v.startsWith(`${n}/`)||v===n))return void f(`URL can't have the same base path as the Studio ${n}`);const $=v===o?o+"/":v;f(void 0),p(void 0),r($.slice(o.length)),(P=d.current)==null||P.blur()}b.key==="Escape"&&(f(void 0),p(void 0))},[n,r,o,h]),w=c.useCallback(()=>{f(void 0),p(void 0)},[]);c.useEffect(()=>{f(void 0),p(void 0)},[o,m]);const g=c.useMemo(()=>({icon:zn}),[]);return a.jsx(a.Fragment,{children:a.jsx(Ln,{clearButton:s?g:void 0,customValidity:s,fontSize:i,onBlur:w,onClear:()=>{f(void 0),p(o+m)},onChange:u,onKeyDownCapture:y,padding:l,style:{zIndex:1},radius:2,ref:d,space:l,value:h===void 0?`${o}${m}`:h})})};function li(e){const{initialUrl:t,openPopup:n,previewLocationOrigin:i,previewLocationRoute:r}=e,o=c.useCallback(l=>{l.preventDefault(),n(l.currentTarget.href)},[n]);return a.jsxs(a.Fragment,{children:[a.jsx(ui,{initialUrl:t,previewLocationOrigin:i,previewLocationRoute:r}),a.jsx(ke,{icon:Tn,text:"Open preview",as:"a",href:`${i}${r}`,onClick:o,rel:"opener",target:"_blank"})]})}function ui(e){const{initialUrl:t,previewLocationOrigin:n,previewLocationRoute:i}=e,{push:r}=Un(),o=Be({apiVersion:Ke}),l=Ve(),[m,d]=c.useState(!1);return a.jsx(ke,{disabled:m,onClick:()=>{if(navigator==null||!navigator.clipboard)return r({closable:!0,status:"error",title:"Clipboard not supported"}),!1;d(!0);let h,p=`${n}${i}`;const s=()=>{r({id:h,closable:!0,status:"success",title:"The URL is copied to the clipboard"}),d(!1)},f=u=>{r({closable:!0,status:"error",title:"Copy failed",description:u.message||u.toString()}),d(!1)};if(dr(t)&&typeof ClipboardItem<"u"){const u="text/plain",y=async()=>{h=r({closable:!0,title:"Copying URL to clipboard…"});const g=await Ht(o,"@sanity/presentation",typeof window>"u"?"":location.href,l==null?void 0:l.id);return p=pr(t,g.secret,i).toString(),new Blob([p],{type:u})},w=new ClipboardItem({[u]:y()});navigator.clipboard.write([w]).then(s).catch(f)}else navigator.clipboard.writeText(p).then(s).catch(f)},text:"Copy link",icon:An})}const We=Tt(W),di=J(Kn)`
  & > span {
    width: 21px;
    height: 13px;
    overflow: hidden;

    & > span:nth-child(1) {
      width: 21px;
      height: 13px;
    }

    & > span:nth-child(2) {
      width: 9px;
      height: 9px;
      top: 2px;
      left: 2px;
    }
  }

  & input:checked + span {
    & > span:nth-child(2) {
      transform: translate3d(8px, 0, 0) !important;
    }
  }
`,Ne={previewDrafts:"Drafts",published:"Published"},pi="caution",fi="positive",Ot={previewDrafts:Mn,published:Dn},hi=c.forwardRef(function(e,t){const{dispatch:n,iframe:i,initialUrl:r,loadersConnection:o,navigatorEnabled:l,onPathChange:m,onRefresh:d,openPopup:h,overlaysConnection:p,params:s,perspective:f,targetOrigin:u,toggleNavigator:y,toggleOverlay:w,viewport:g,visualEditing:{overlaysEnabled:b}}=e,{devMode:P}=ze(),v=dn(),$=c.useCallback(()=>n({type:Ye,viewport:"desktop"}),[n]),j=c.useCallback(()=>n({type:Ye,viewport:"mobile"}),[n]),k=i.status==="loading"||i.status==="reloading",[R,O]=c.useState(!1),I=i.status==="refreshing",[z,_]=c.useState(!1),pe=k||I||p==="connecting",te=c.useMemo(()=>u===location.origin?"":u,[u]),fe=c.useCallback(()=>{d(()=>{typeof t=="function"||t==null||!t.current||(n({type:Ze}),t.current.src=`${u}${s.preview||"/"}`)})},[n,d,s.preview,u,t]),U=c.useCallback(()=>{typeof t=="function"||t==null||!t.current||(t.current.src=r.toString(),n({type:Ze}))},[n,t,r]),ne=c.useCallback(()=>{oe(!0)},[]),[A,oe]=c.useState(!1),[ae,he]=c.useState(!1);c.useEffect(()=>{if(!(k||I||p!=="connecting"&&p!=="reconnecting")){const N=setTimeout(()=>{he(!0)},1e3);return()=>clearTimeout(N)}},[p,k,I]),c.useEffect(()=>{if(!k&&!I&&ae){if(p==="connected"&&(_(!1),he(!1),O(!1),oe(!1)),p==="connecting"){const N=setTimeout(()=>{O(!0),console.error("Unable to connect to visual editing. Make sure you've setup '@sanity/visual-editing' correctly")},dt);return()=>clearTimeout(N)}if(p==="reconnecting"){const N=setTimeout(()=>{O(!0),_(!0)},dt);return()=>clearTimeout(N)}p==="disconnected"&&_(!0)}},[k,p,I,ae]);const G=c.useMemo(()=>{const N=new URL(s.preview||"/",u),{pathname:F,search:ue}=ur(N);return`${F}${ue}`},[s.preview,u]),re=c.useCallback(()=>{n({type:st})},[n]);return c.useEffect(()=>{if(typeof t=="function"||t==null||!t.current)return;const N=t.current;function F(){N===document.activeElement&&N.dispatchEvent(new MouseEvent("mousedown",{bubbles:!0,cancelable:!0}))}return window.addEventListener("blur",F),()=>{window.removeEventListener("blur",F)}},[t]),a.jsx(Jn,{transition:v?{duration:0}:void 0,children:a.jsxs(pn,{delay:1e3,children:[a.jsx(ie,{flex:"none",padding:2,shadow:1,style:{position:"relative"},children:a.jsxs(W,{align:"center",gap:2,style:{minHeight:0},children:[y&&a.jsx(ye,{animate:!0,content:a.jsx(T,{size:1,children:"Toggle navigator"}),fallbackPlacements:["bottom-start"],padding:2,placement:"bottom",portal:!0,children:a.jsx(Y,{"aria-label":"Toggle navigator",fontSize:1,icon:fn,mode:"bleed",onClick:y,padding:3,selected:l})}),a.jsx(ye,{animate:!0,content:a.jsxs(W,{align:"center",style:{whiteSpace:"nowrap"},children:[a.jsx(ee,{padding:1,children:a.jsx(T,{size:1,children:b?"Disable edit overlay":"Enable edit overlay"})}),a.jsx(ee,{paddingY:1,children:a.jsx(hn,{keys:["Alt"],style:{marginTop:-4,marginBottom:-4}})})]}),fallbackPlacements:["bottom-start"],padding:1,placement:"bottom",portal:!0,children:a.jsx(ie,{as:"label",flex:"none",padding:3,style:{lineHeight:0,borderRadius:999,userSelect:"none"},tone:b?"positive":void 0,children:a.jsxs(W,{align:"center",gap:2,children:[a.jsx("div",{style:{margin:-2},children:a.jsx(di,{checked:b,onChange:w,disabled:i.status==="loading"||p!=="connected"})}),a.jsx(ee,{children:a.jsx(T,{muted:!0,size:1,weight:"medium",children:"Edit"})})]})})}),a.jsx(ye,{animate:!0,content:a.jsx(T,{size:1,children:i.status==="loading"?"Loading…":i.status==="reloading"||i.status==="refreshing"?"Refreshing…":"Refresh preview"}),fallbackPlacements:["bottom-start"],padding:2,placement:"bottom",portal:!0,children:a.jsx(Y,{"aria-label":"Refresh preview",fontSize:1,icon:mn,mode:"bleed",loading:i.status==="reloading"||i.status==="refreshing",onClick:fe,padding:3})}),a.jsx(ee,{flex:1,children:a.jsx(ci,{onChange:m,origin:te,value:G})}),a.jsx(W,{align:"center",flex:"none",gap:1,children:a.jsx(pt,{button:a.jsx(Y,{fontSize:1,iconRight:vn,mode:"bleed",padding:3,space:2}),id:"location-menu",menu:a.jsx(ft,{children:a.jsx(li,{initialUrl:r,openPopup:h,previewLocationOrigin:te,previewLocationRoute:G})}),popover:{animate:!0,constrainSize:!0,placement:"bottom",portal:!0}})}),a.jsx(W,{align:"center",flex:"none",gap:1,children:a.jsx(pt,{button:a.jsx(Y,{fontSize:1,iconRight:gn,mode:"bleed",padding:3,space:2,text:Ne[o==="connected"?f:"previewDrafts"],loading:o==="reconnecting"&&i.status!=="loaded",disabled:o!=="connected"}),id:"perspective-menu",menu:a.jsxs(ft,{style:{maxWidth:240},children:[a.jsx(ke,{fontSize:1,onClick:()=>n({type:Qe,perspective:"previewDrafts"}),padding:3,pressed:f==="previewDrafts",tone:pi,children:a.jsxs(W,{align:"flex-start",gap:3,children:[a.jsx(ee,{flex:"none",children:a.jsx(T,{size:1,children:c.createElement(Ot.previewDrafts)})}),a.jsxs(le,{flex:1,space:2,children:[a.jsx(T,{size:1,weight:"medium",children:Ne.previewDrafts}),a.jsx(T,{muted:!0,size:1,children:"View this page with latest draft content"})]}),a.jsx(ee,{flex:"none",children:a.jsx(T,{muted:!0,size:1,style:{opacity:f==="previewDrafts"?1:0},children:a.jsx(ht,{})})})]})}),a.jsx(ke,{fontSize:1,onClick:()=>n({type:Qe,perspective:"published"}),padding:3,pressed:f==="published",tone:fi,children:a.jsxs(W,{align:"flex-start",gap:3,children:[a.jsx(ee,{flex:"none",children:a.jsx(T,{size:1,children:c.createElement(Ot.published)})}),a.jsxs(le,{flex:1,space:2,children:[a.jsx(T,{size:1,weight:"medium",children:Ne.published}),a.jsx(T,{muted:!0,size:1,children:"View this page with published content"})]}),a.jsx(ee,{flex:"none",children:a.jsx(T,{muted:!0,size:1,style:{opacity:f==="published"?1:0},children:a.jsx(ht,{})})})]})})]}),popover:{animate:!0,constrainSize:!0,placement:"bottom",portal:!0}})}),a.jsxs(W,{align:"center",flex:"none",gap:1,children:[a.jsx(ye,{animate:!0,content:a.jsx(T,{size:1,children:"Full viewport"}),fallbackPlacements:["bottom-start"],padding:2,placement:"bottom",portal:!0,children:a.jsx(Y,{"aria-label":"Full viewport",fontSize:1,icon:yn,mode:"bleed",onClick:$,padding:3,selected:g==="desktop"})}),a.jsx(ye,{animate:!0,content:a.jsx(T,{size:1,children:"Narrow viewport"}),padding:2,placement:"bottom",portal:!0,children:a.jsx(Y,{"aria-label":"Narrow viewport",fontSize:1,icon:bn,mode:"bleed",onClick:j,padding:3,selected:g==="mobile"})})]})]})}),a.jsx(ie,{flex:1,tone:"transparent",children:a.jsxs(W,{align:"center",height:"fill",justify:"center",padding:g==="desktop"?0:2,sizing:"border",style:{position:"relative",cursor:pe?"wait":void 0},children:[a.jsx(wn,{children:z||k||I||!ae||A?(k||p==="connecting"&&i.status!=="refreshing")&&!A?a.jsx(We,{initial:"initial",animate:"animate",exit:"exit",variants:zt,justify:"center",align:"center",style:{inset:"0",position:"absolute"},children:a.jsxs(W,{style:{...$e[g]},justify:"center",align:"center",direction:"column",gap:4,children:[a.jsx(mt,{muted:!0}),a.jsx(T,{muted:!0,size:1,children:"Loading…"})]})}):z&&!A?a.jsx(We,{initial:"initial",animate:"animate",exit:"exit",variants:mi,justify:"center",align:"center",style:{background:"var(--card-bg-color)",inset:"0",position:"absolute",borderTop:"1px solid transparent",boxShadow:"0 0 0 1px var(--card-border-color)"},children:a.jsx(at,{flex:1,message:"Could not connect to the preview",onRetry:U,onContinueAnyway:ne,children:P&&a.jsxs(a.Fragment,{children:[p!=="connected"&&a.jsx(ie,{padding:3,radius:2,tone:"critical",children:a.jsxs(le,{space:3,children:[a.jsx(Se,{muted:!0,size:0,children:"Overlay connection status"}),a.jsx(Ce,{size:1,children:p})]})}),o!=="connected"&&a.jsx(ie,{padding:3,radius:2,tone:"critical",children:a.jsxs(le,{space:3,children:[a.jsx(Se,{muted:!0,size:0,children:"Loader connection status"}),a.jsx(Ce,{size:1,children:o})]})})]})})}):null:a.jsx(We,{initial:"initial",animate:"animate",exit:"exit",variants:zt,justify:"center",align:"center",style:{inset:"0",position:"absolute",backdropFilter:R?"blur(16px) saturate(0.5) grayscale(0.5)":"blur(2px)",transition:"backdrop-filter 0.2s ease-in-out",WebkitBackdropFilter:R?"blur(16px) saturate(0.5) grayscale(0.5)":"blur(2px)",WebkitTransition:"-webkit-backdrop-filter 0.2s ease-in-out",zIndex:1},children:a.jsxs(W,{style:{...$e[g]},justify:"center",align:"center",direction:"column",gap:4,children:[R&&a.jsx(Y,{disabled:!0,fontSize:1,mode:"ghost",text:"Continue anyway",style:{opacity:0}}),a.jsx(ie,{radius:2,tone:R?"caution":"inherit",padding:4,shadow:1,children:a.jsxs(W,{justify:"center",align:"center",direction:"column",gap:4,children:[a.jsx(mt,{muted:!0}),a.jsx(T,{muted:!0,size:1,children:R?a.jsx(a.Fragment,{children:"Unable to connect, check the browser console for more information."}):"Connecting…"})]})}),R&&a.jsx(Y,{fontSize:1,tone:"critical",onClick:ne,text:"Continue anyway"})]})})}),a.jsx(si,{ref:t,style:{pointerEvents:(k||p==="connecting"&&i.status!=="refreshing")&&!A?"none":"auto",boxShadow:"0 0 0 1px var(--card-border-color)",borderTop:"1px solid transparent"},src:r.toString(),initial:["background"],variants:vi,animate:[(k||p==="connecting"&&i.status!=="refreshing")&&!A?"background":"active",k?"reloading":"idle",g,ae&&!A?"timedOut":""],onLoad:re})]})})]})})}),$e={desktop:{width:"100%",height:"100%"},mobile:{width:375,height:650}},zt={initial:{opacity:1},animate:{opacity:[0,0,1]},exit:{opacity:[1,0,0]}},mi={initial:{opacity:1},animate:{opacity:[0,0,1]},exit:{opacity:[1,0,0]}},vi={desktop:{...$e.desktop,boxShadow:"0 0 0 0px var(--card-border-color)"},mobile:{...$e.mobile,boxShadow:"0 0 0 1px var(--card-border-color)"},background:{opacity:0,scale:1},idle:{scale:1},reloading:{scale:[1,1,1,.98]},active:{opacity:[0,0,1],scale:1},timedOut:{opacity:[0,0,1]}};let Lt=!1;function gi(e){var t;if(e===void 0)return;const n=(t=decodeURIComponent(e))==null?void 0:t.split(".");return n[0]==="drafts"&&n.shift(),n.join(".")}function yi(e){if(e!==void 0)return Jt.toString(function(t){const n=[];for(const i of t.split(".")){const r=$r.exec(i);if(r){n.push(r[1],Number(r[2]));continue}const o=Ir.exec(i);if(o){n.push(o[1],[Number(o[2]),Number(o[3])]);continue}const l=Rr.exec(i);l?n.push(l[1],{_key:l[2]}):n.push(i)}return n}(decodeURIComponent(e)))}function Fe(e){return Object.fromEntries(Object.entries(e).filter(([,t])=>t!==void 0&&t!==""&&t!==null))}function bi({initialPreviewUrl:e,routerNavigate:t,routerState:n,routerSearchParams:i,frameStateRef:r}){const o=c.useMemo(()=>{const{id:d,path:h,type:p}={id:gi((s=n).id),path:yi(s.path),type:s.type};var s;return{id:d,type:p,path:h,preview:i.preview||`${e.pathname}${e.search}`,perspective:i.perspective,viewport:i.viewport,inspect:i.inspect,rev:i.rev,since:i.since,template:i.template,templateParams:i.templateParams,view:i.view,pathKey:i.pathKey,instruction:i.instruction,comment:i.comment}},[n,i,e]),l=c.useMemo(()=>Fe({inspect:o.inspect,path:o.path,rev:o.rev,since:o.since,template:o.template,templateParams:o.templateParams,view:o.view,pathKey:o.pathKey,instruction:o.instruction,comment:o.comment}),[o.comment,o.inspect,o.instruction,o.path,o.pathKey,o.rev,o.since,o.template,o.templateParams,o.view]),m=c.useRef(n);return c.useEffect(()=>{m.current=n},[n]),{structureParams:l,navigate:c.useMemo(()=>tn((d,h={},p)=>{d.id&&(d.id=Bt(d.id));const{_searchParams:s,...f}=m.current,u=(s||[]).reduce((b,[P,v])=>(b[P]=v,b),{}),y=Fe({...f,...d}),w=Fe({...u,...h});f.id!==y.id&&(delete w.template,delete w.templateParams),y._searchParams=Object.entries(w).reduce((b,[P,v])=>[...b,[P,v]],[]);const g=p??w.preview===r.current.url;t(y,{replace:g})},50),[t,r]),params:o}}function wi(e,t,n){var i,r;const o=Be({apiVersion:Ke}),l=Wt(),m=((i=l==null?void 0:l.activeWorkspace)==null?void 0:i.basePath)||"/",d=((r=l==null?void 0:l.activeWorkspace)==null?void 0:r.name)||"default",h=function(s,f,u){const y=Ve();return c.useMemo(()=>["@sanity/presentation",f,u,s,y==null?void 0:y.id,xi],[f,y==null?void 0:y.id,s,u])}(t,m,d),p=function(s,f){const u=Be({apiVersion:Ke}),y=Ve(),[w,g]=c.useState(""),b=s?wt(async()=>await Ht(u,"@sanity/presentation",typeof window>"u"?"":location.href,y==null?void 0:y.id),[...f,w]):null;return c.useEffect(()=>{if(!b)return;const P=setTimeout(()=>{c.startTransition(()=>g(b.expiresAt.toString()))},b.expiresAt.getTime()-Date.now());return()=>clearTimeout(P)},[b]),(b==null?void 0:b.secret)||null}(typeof e=="object"||typeof e=="function",h);return wt(async()=>{if(typeof e=="string"){const f=new URL(e,location.origin);let u=f;try{if(n){const y=new URL(n,f);y.origin===f.origin&&(u=y)}else if(document.referrer){const y=new URL(document.referrer);y.origin===f.origin&&(u=y)}}catch{}return location.origin!==u.origin||!u.pathname.startsWith(`${m}/`)&&u.pathname!==m?u:f}const s=await(typeof e=="object"?fr(e):e)({client:o,previewUrlSecret:p,previewSearchParam:n,referrer:typeof document>"u"?null:document.referrer,studioBasePath:m});return new URL(s,location.origin)},[...h,p])}const xi=Symbol(),ji=c.lazy(()=>Ut(()=>import("./LoaderQueries-6c5eaa98.js"),["static/LoaderQueries-6c5eaa98.js","static/sanity-cf546c8f.js","static/DisplayedDocumentBroadcaster-6f8aacdc.js"])),Pi=c.lazy(()=>Ut(()=>import("./PostMessageRefreshMutations-dd3a3d0a.js"),["static/PostMessageRefreshMutations-dd3a3d0a.js","static/sanity-cf546c8f.js"])),Ei=J(W)`
  overflow-x: auto;
`;function ki(e){var t;const{previewUrl:n,components:i}=(t=e.tool.options)!=null?t:{},r=e.tool.name||xn,{unstable_navigator:o}=i||{},{navigate:l,state:m}=At(),d=Mt(Object.fromEntries(m._searchParams||[])),h=wi(n||"/",r,d.preview||null),[p]=c.useState(()=>{var E;const S=(E=e.tool.options)==null?void 0:E.devMode;return typeof S=="function"?S():typeof S=="boolean"?S:typeof window<"u"&&window.location.hostname==="localhost"}),s=c.useMemo(()=>h.origin,[h.origin]),f=c.useRef(null),[u,y]=c.useState(),[w,g]=c.useState({}),b=c.useRef({title:void 0,url:void 0}),{navigate:P,params:v,structureParams:$}=bi({initialPreviewUrl:h,routerNavigate:l,routerState:m,routerSearchParams:d,frameStateRef:b}),[j,k]=c.useReducer(ti,{perspective:v.perspective,viewport:v.viewport},ai),[R,O]=function(E,S){if(E!=="published"&&E!=="previewDrafts")throw new Error(`Invalid perspective: ${E}`);const[L,C]=c.useState({}),[x,V]=c.useState({}),B=c.useRef(""),ve=c.useCallback((se,M,ce=[])=>{const q=ce.filter(Q=>"_projectId"in Q&&Q._projectId?(Lt||(console.warn("Cross dataset references are not supported yet, ignoring source document",Q),Lt=!0),!1):Q);(M==="published"?C:V)(Q=>{const ge={};for(const we of q)ge[we._id]=we;if(B.current!==S.current.url)return B.current=S.current.url,{[se]:ge};const be=Q[se];return Vn(be,ge)?Q:{...Q,[se]:ge}})},[S]);return[c.useMemo(()=>{const se=Object.values(E==="published"?L:x).reduce((M,ce)=>(Object.values(ce).forEach(q=>{M[q._id]=q}),M),{});return Object.values(se)},[E,x,L]),ve]}(j.perspective,b),I=jn(),z=Pn();c.useEffect(()=>{(j.perspective!==v.perspective||j.viewport!==v.viewport)&&P({},{perspective:j.perspective==="previewDrafts"?void 0:j.perspective,viewport:j.viewport==="desktop"?void 0:j.viewport})},[v.perspective,j.perspective,P,j.viewport,v.viewport]);const[_,pe]=c.useState("connecting"),[te,fe]=c.useState("connecting"),[U,ne]=c.useState("connecting"),[A]=c.useState(()=>new Set),oe=c.useCallback(E=>{const S=window.open(E,"_blank");S&&A.add(S)},[A]);c.useEffect(()=>{if(A.size&&u)for(const E of A)E&&"closed"in E&&!E.closed&&u.addSource(E)},[u,A,A.size]),c.useEffect(()=>{var E;const S=(E=f.current)==null?void 0:E.contentWindow;if(!S)return;const L=function(C){const{destroy:x,send:V}=Pt(C),B=new Set,ve=new WeakMap,se=new Set;return{destroy:()=>{x();for(const M of se)M()},send:(M,...ce)=>{V(M,...ce);for(const q of B)q&&"closed"in q&&!q.closed&&ve.has(q)&&ve.get(q)(M,...ce)},addSource(M){if(B.has(M))return;if(!("closed"in M))throw console.warn("Source is unsupported",{source:M}),new Error("Source is unsupported");if(M.closed)throw new Error("Source is closed");const{send:ce,destroy:q}=Pt({...C,target:M,connectTo:C.connectTo.map(Q=>{const{onStatusUpdate:ge,onEvent:be,...we}=Q;return{...we,onEvent:be?(...lt)=>{const[Ue]=lt;if(Ue!=="preview-kit/documents"&&Ue!=="overlay/navigate"&&Ue!=="loader/documents")return be(...lt)}:void 0}})});se.add(q),ve.set(M,ce),B.add(M)}}}({id:"presentation",target:S,targetOrigin:s,connectTo:[{id:"overlays",heartbeat:!0,onStatusUpdate:pe,onEvent(C,x){if(C!=="visual-editing/focus"&&C!=="overlay/focus"||!("id"in x))if(C==="visual-editing/navigate"||C==="overlay/navigate"){const{title:V,url:B}=x;b.current.url!==B&&P({},{preview:B}),b.current={title:V,url:B}}else C==="visual-editing/meta"?b.current.title=x.title:C==="visual-editing/toggle"||C==="overlay/toggle"?k({type:rn,enabled:x.enabled}):C==="visual-editing/documents"?O("visual-editing",x.perspective,x.documents):C==="visual-editing/refreshing"&&x.source==="manual"?clearTimeout(Z.current):C==="visual-editing/refreshing"&&x.source==="mutation"?k({type:Xe}):C==="visual-editing/refreshed"&&k({type:st});else P({type:x.type,id:x.id,path:x.path})}},{id:"loaders",heartbeat:!0,onStatusUpdate:fe,onEvent(C,x){if(C==="loader/documents"&&x.projectId===I&&x.dataset===z)O("loaders",x.perspective,x.documents);else if(C==="loader/query-listen"&&x.projectId===I&&x.dataset===z){if(typeof x.heartbeat=="number"&&x.heartbeat<Ae)throw new Error(`Loader query listen heartbeat interval must be at least ${Ae}ms`);g(V=>{var B;return{...V,[_r(x.query,x.params)]:{perspective:x.perspective,query:x.query,params:x.params,receivedAt:Date.now(),heartbeat:(B=x.heartbeat)!=null&&B}}})}}},{id:"preview-kit",heartbeat:!0,onStatusUpdate:ne,onEvent(C,x){C==="preview-kit/documents"&&x.projectId===I&&x.dataset===z&&O("preview-kit",x.perspective,x.documents)}}]});return y(L),()=>{L.destroy(),y(void 0)}},[z,I,O,P,s]),c.useEffect(()=>{const E=setInterval(()=>c.startTransition(()=>g(S=>{if(Object.keys(S).length<1)return S;const L=Date.now();if(!Object.values(S).some(x=>x.heartbeat!==!1&&L>x.receivedAt+x.heartbeat))return S;const C={};for(const[x,V]of Object.entries(S))V.heartbeat!==!1&&L>V.receivedAt+V.heartbeat||(C[x]=V);return C})),Ae);return()=>clearInterval(E)},[]);const ae=c.useCallback(E=>{P({path:Jt.toString(E)},{},!0)},[P]),he=c.useCallback(E=>{const S=new URL(E,h.origin),L=S.pathname+S.search;S.origin===h.origin&&L!==v.preview&&P({},{preview:L})},[h,v,P]),G=c.useCallback(E=>{P({},E)},[P]);c.useEffect(()=>{u==null||u.send("overlays","presentation/perspective",{perspective:j.perspective})},[u,j.perspective]),c.useEffect(()=>{v.id&&v.path?u==null||u.send("overlays","presentation/focus",{id:v.id,path:v.path}):u==null||u.send("overlays","presentation/blur",void 0)},[u,v.id,v.path]),c.useEffect(()=>{b.current.url&&v.preview&&b.current.url!==v.preview&&(b.current.url=v.preview,_!=="connected"&&f.current?f.current.src=`${s}${v.preview}`:u==null||u.send("overlays","presentation/navigate",{url:v.preview,type:"replace"}))},[u,_,s,v.preview]);const re=c.useCallback(()=>u==null?void 0:u.send("overlays","presentation/toggleOverlay",void 0),[u]),[N,F]=c.useState(null);c.useEffect(()=>{const E=L=>{kt(L)&&re()},S=L=>{var C;kt(L)&&re(),C=L,["mod","\\"].every(x=>Et[x]?C[Et[x]]:C.key===x.toUpperCase())&&re()};return window.addEventListener("keydown",S),window.addEventListener("keyup",E),()=>{window.removeEventListener("keydown",S),window.removeEventListener("keyup",E)}},[re]);const[ue,de]=c.useState(null),[{navigatorEnabled:me,toggleNavigator:H},X]=Zr({unstable_navigator:o}),K=c.useRef(v.id);c.useEffect(()=>{v.rev&&K.current&&v.id!==K.current&&P({},{rev:void 0}),K.current=v.id});const Z=c.useRef(),Te=c.useCallback(E=>{if(k({type:Xe}),u)return Z.current=window.setTimeout(E,300),void u.send("overlays","presentation/refresh",{source:"manual",livePreviewEnabled:U==="connected"||te==="connected"});E()},[u,te,U]),ct=En(),sn=c.useCallback(({id:E,type:S,path:L})=>{if(b.current.url)return{title:b.current.title||b.current.url,name:"edit",params:{id:E,path:L,type:S,inspect:kn,workspace:ct.name,mode:Sn,preview:v.preview}}},[v.preview,ct.name]);return a.jsxs(a.Fragment,{children:[a.jsx(ei,{devMode:p,name:r,navigate:P,params:v,structureParams:$,children:a.jsx(Xr,{navigate:P,children:a.jsx(Yr,{params:v,children:a.jsx(Ei,{height:"fill",children:a.jsxs(Hr,{children:[a.jsx(X,{}),a.jsx(Ge,{id:"preview",minWidth:325,defaultSize:me?50:75,order:3,children:a.jsx(W,{direction:"column",flex:1,height:"fill",ref:de,children:a.jsx(Cn,{element:ue,children:a.jsx(hi,{dispatch:k,iframe:j.iframe,initialUrl:h,loadersConnection:te,navigatorEnabled:me,onPathChange:he,onRefresh:Te,openPopup:oe,overlaysConnection:_,params:v,perspective:j.perspective,ref:f,targetOrigin:s,toggleNavigator:H,toggleOverlay:re,viewport:j.viewport,visualEditing:j.visualEditing})})})}),a.jsx(en,{order:4}),a.jsx(Ge,{id:"content",minWidth:325,order:5,children:a.jsx(qn,{documentId:v.id,setDisplayedDocument:F,children:a.jsx($n,{getIntent:sn,children:a.jsx(Fr,{documentId:v.id,documentType:v.type,onFocusPath:ae,onStructureParams:G,previewUrl:v.preview,refs:R,structureParams:$})})})})]})})})})}),u&&a.jsx(c.Suspense,{children:a.jsx(ji,{channel:u,liveQueries:w,perspective:j.perspective,liveDocument:N,documentsOnPage:R})}),u&&v.id&&v.type&&a.jsx(c.Suspense,{children:a.jsx(Pi,{channel:u,id:v.id,type:v.type,loadersConnection:te,previewKitConnection:U})})]})}const _i=Object.freeze(Object.defineProperty({__proto__:null,default:ki},Symbol.toStringTag,{value:"Module"}));export{vt as D,_i as P,Xn as a,$i as g,Ii as p,Ri as r,Zn as t,Me as w};
